[tox]
envlist = test, lint, typecheck, format-check
skip_missing_interpreters = true

[testenv:test]
skip_install = true
deps = 
    pytest>=8.4.1
    pytest-cov>=6.2.1
    mcp[cli]>=1.12.2
commands = pytest --cov=. --cov-report=term-missing {posargs}
# Allow network access for package installation
passenv = 
    PYTHONPATH
    HOME
    USER

[testenv:lint]
skip_install = true
deps = ruff>=0.12.5
commands = ruff check {posargs:.}
passenv = 
    PYTHONPATH
    HOME
    USER

[testenv:format]
skip_install = true
deps = ruff>=0.12.5
commands = ruff format {posargs:.}
passenv = 
    PYTHONPATH
    HOME
    USER

[testenv:format-check]
skip_install = true
deps = ruff>=0.12.5
commands = ruff format --check {posargs:.}
passenv = 
    PYTHONPATH
    HOME
    USER

[testenv:typecheck]
skip_install = true
deps = 
    mypy>=1.8.0
    mcp[cli]>=1.12.2
    pytest>=8.4.1
commands = mypy {posargs:.}
passenv = 
    PYTHONPATH
    HOME
    USER

[testenv:all]
skip_install = true
deps =
    pytest>=8.4.1
    pytest-cov>=6.2.1
    ruff>=0.12.5
    mypy>=1.8.0
    mcp[cli]>=1.12.2
commands =
    ruff check .
    ruff format --check .
    mypy .
    pytest --cov=. --cov-report=term-missing
passenv = 
    PYTHONPATH
    HOME
    USER

# Python version-specific testing environments
[testenv:py311]
basepython = python3.11
skip_install = true
deps = 
    pytest>=8.4.1
    pytest-cov>=6.2.1
    mcp[cli]>=1.12.2
commands = pytest --cov=. --cov-report=term-missing {posargs}
passenv = 
    PYTHONPATH
    HOME
    USER

[testenv:py313]
basepython = python3.13
skip_install = true
deps = 
    pytest>=8.4.1
    pytest-cov>=6.2.1
    mcp[cli]>=1.12.2
commands = pytest --cov=. --cov-report=term-missing {posargs}
passenv = 
    PYTHONPATH
    HOME
    USER